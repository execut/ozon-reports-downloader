# Утилита для автоскачивания различных отчётов в Ozon Seller
Постоянно требуются различные отчёты, по которым нужно производить аналитику. Чтобы этого не делать, я
разработал специальный скачиватель отчётов. Для того, чтобы скачать десяток отчётов, достаточно один раз запустить
команду и скачиватель отчётов сохранит их все в одну папку разом.

## Требования
Нужен Linux\MacOS и установленный go. На Windows должно работать, но не тестировал

## Настройка
Создать файл настройки на примере config.example.yml
```
cp config.example.yml config.yml
```
Заполнить его своими данными:

* **cookie** - все кукисы, которые браузер передаёт при скачивании одного из ваших отчётов. Их нужно периодически обновлять на актуальные.
Можно подсмотреть во вкладке консоли разработчика браузера Chrome Network -> кликнуть на произвольный запрос, который скачивал отчёт и скопировать там значение заголовка Cookie 
* **companyID** - номер компании. Можно подсмотреть тоже в заголовках браузера, либо на странице https://id.ozon.ru/ во вкладке
Ozon Seller -> Развернуть через кнопку рядом с почтой -> цифры после строчки "Seller ID: sc-"
* **organizationID** - номер организации. Можно посмотреть в заголовках браузера

## Использование:
```
git clone 
go run main.go 2025-01-01
```
Где 2025-01-01 - день, от которой вам нужно скачивать аналитику.

После запуска в папке reports появятся отчёты:

```bash
ls reports/
01-trafarets.xlsx  02-search_promotion_orders.csv  03-fbo.csv  04-fbs.csv  05-returns-FBOS.xlsx  06-returns-RealFBS.xlsx  08-analytics.xlsx  09-accruals.xlsx  10-leftovers.xlsx
```

## Поддерживаемые отчёты:
* Трафареты
* Заказы FBO
* Заказы FBS
* Возвраты FBO и FBS
* Возвраты RealFBS
* Аналитика
* Возвраты
* Стоимость хранения
* Цены